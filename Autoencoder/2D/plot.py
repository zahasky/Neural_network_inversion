#This file is used to plot the encoded image (tensor1), latent space (tensor2),
#and decoded image (tensor3).
#Also, the overall loss (g_l) and its components will also be plotted.
import numpy as np
import math
import os
import matplotlib.pyplot as plt

from mpl_toolkits.axes_grid1 import make_axes_locatable

tensor1 =[[-9.5546e-06,  3.9580e-04,  4.5028e-04,  4.7383e-04,  4.7103e-04,
          4.7297e-04,  4.6495e-04,  4.5786e-04,  4.4852e-04,  4.4512e-04,
          4.4398e-04,  4.4129e-04,  4.4272e-04,  4.5616e-04,  4.8098e-04,
          5.0423e-04,  5.2526e-04,  5.4635e-04,  5.6815e-04,  5.9252e-04,
          6.1625e-04,  6.4371e-04,  6.7894e-04,  7.2085e-04,  7.6386e-04,
          8.0057e-04,  8.2912e-04,  8.5234e-04,  8.7169e-04,  8.8790e-04,
          9.0186e-04,  9.1460e-04,  9.3023e-04,  9.5036e-04,  9.7634e-04,
          1.0066e-03,  1.0366e-03,  1.0349e-03,  8.3756e-04, -3.8247e-04],
        [-9.5948e-06,  3.9486e-04,  4.4758e-04,  4.6986e-04,  4.6772e-04,
          4.7172e-04,  4.6585e-04,  4.6085e-04,  4.5462e-04,  4.5682e-04,
          4.6377e-04,  4.6874e-04,  4.7591e-04,  4.9241e-04,  5.1704e-04,
          5.3775e-04,  5.5537e-04,  5.7405e-04,  5.9784e-04,  6.2472e-04,
          6.5256e-04,  6.8259e-04,  7.1750e-04,  7.5434e-04,  7.9054e-04,
          8.2018e-04,  8.4371e-04,  8.6468e-04,  8.8448e-04,  9.0313e-04,
          9.2056e-04,  9.3825e-04,  9.5844e-04,  9.8339e-04,  1.0141e-03,
          1.0475e-03,  1.0764e-03,  1.0689e-03,  8.6173e-04, -3.7026e-04],
        [-1.0575e-05,  3.9319e-04,  4.4518e-04,  4.6775e-04,  4.6687e-04,
          4.7268e-04,  4.6887e-04,  4.6740e-04,  4.6712e-04,  4.7710e-04,
          4.9234e-04,  5.0492e-04,  5.1759e-04,  5.3702e-04,  5.6238e-04,
          5.8274e-04,  5.9804e-04,  6.1705e-04,  6.4258e-04,  6.7376e-04,
          7.0591e-04,  7.3812e-04,  7.7207e-04,  8.0576e-04,  8.3514e-04,
          8.5803e-04,  8.7643e-04,  8.9546e-04,  9.1675e-04,  9.3983e-04,
          9.6125e-04,  9.8215e-04,  1.0059e-03,  1.0350e-03,  1.0692e-03,
          1.1033e-03,  1.1292e-03,  1.1151e-03,  9.0080e-04, -3.4044e-04],
        [-1.1169e-05,  3.9176e-04,  4.4399e-04,  4.6790e-04,  4.6860e-04,
          4.7584e-04,  4.7436e-04,  4.7707e-04,  4.8316e-04,  5.0072e-04,
          5.2303e-04,  5.4149e-04,  5.5873e-04,  5.8133e-04,  6.0782e-04,
          6.2792e-04,  6.4609e-04,  6.6750e-04,  6.9663e-04,  7.3160e-04,
          7.6619e-04,  7.9770e-04,  8.2824e-04,  8.5640e-04,  8.8039e-04,
          8.9968e-04,  9.1692e-04,  9.3666e-04,  9.5987e-04,  9.8598e-04,
          1.0098e-03,  1.0336e-03,  1.0617e-03,  1.0950e-03,  1.1318e-03,
          1.1664e-03,  1.1898e-03,  1.1701e-03,  9.4721e-04, -3.0265e-04],
        [-1.1065e-05,  3.9247e-04,  4.4629e-04,  4.7182e-04,  4.7390e-04,
          4.8272e-04,  4.8400e-04,  4.9179e-04,  5.0453e-04,  5.2871e-04,
          5.5710e-04,  5.8034e-04,  6.0079e-04,  6.2474e-04,  6.5175e-04,
          6.7246e-04,  6.9243e-04,  7.1808e-04,  7.5203e-04,  7.9015e-04,
          8.2526e-04,  8.5528e-04,  8.8223e-04,  9.0627e-04,  9.2782e-04,
          9.4602e-04,  9.6351e-04,  9.8505e-04,  1.0105e-03,  1.0369e-03,
          1.0631e-03,  1.0904e-03,  1.1224e-03,  1.1592e-03,  1.1968e-03,
          1.2282e-03,  1.2477e-03,  1.2228e-03,  9.9374e-04, -2.6177e-04],
        [-9.7554e-06,  3.9568e-04,  4.5137e-04,  4.7826e-04,  4.8128e-04,
          4.9230e-04,  4.9814e-04,  5.1226e-04,  5.3178e-04,  5.6210e-04,
          5.9457e-04,  6.2016e-04,  6.4176e-04,  6.6646e-04,  6.9427e-04,
          7.1767e-04,  7.4169e-04,  7.7200e-04,  8.0955e-04,  8.4954e-04,
          8.8394e-04,  9.1069e-04,  9.3396e-04,  9.5544e-04,  9.7570e-04,
          9.9416e-04,  1.0135e-03,  1.0368e-03,  1.0626e-03,  1.0910e-03,
          1.1192e-03,  1.1498e-03,  1.1858e-03,  1.2243e-03,  1.2602e-03,
          1.2889e-03,  1.3018e-03,  1.2725e-03,  1.0407e-03, -2.1678e-04],
        [-8.1889e-06,  3.9952e-04,  4.5714e-04,  4.8527e-04,  4.9055e-04,
          5.0573e-04,  5.1742e-04,  5.3787e-04,  5.6305e-04,  5.9722e-04,
          6.3223e-04,  6.5936e-04,  6.8164e-04,  7.0720e-04,  7.3726e-04,
          7.6446e-04,  7.9285e-04,  8.2779e-04,  8.6797e-04,  9.0732e-04,
          9.3831e-04,  9.6094e-04,  9.8101e-04,  1.0006e-03,  1.0212e-03,
          1.0416e-03,  1.0628e-03,  1.0878e-03,  1.1169e-03,  1.1475e-03,
          1.1796e-03,  1.2137e-03,  1.2507e-03,  1.2883e-03,  1.3229e-03,
          1.3474e-03,  1.3571e-03,  1.3244e-03,  1.0907e-03, -1.6717e-04],
        [-6.4536e-06,  4.0307e-04,  4.6186e-04,  4.9150e-04,  4.9960e-04,
          5.1989e-04,  5.3780e-04,  5.6403e-04,  5.9351e-04,  6.3083e-04,
          6.6780e-04,  6.9571e-04,  7.1892e-04,  7.4625e-04,  7.7917e-04,
          8.1064e-04,  8.4340e-04,  8.8094e-04,  9.2100e-04,  9.5790e-04,
          9.8484e-04,  1.0041e-03,  1.0227e-03,  1.0433e-03,  1.0659e-03,
          1.0888e-03,  1.1122e-03,  1.1385e-03,  1.1691e-03,  1.2027e-03,
          1.2378e-03,  1.2748e-03,  1.3134e-03,  1.3493e-03,  1.3792e-03,
          1.4000e-03,  1.4074e-03,  1.3741e-03,  1.1421e-03, -1.1292e-04],
        [-5.5297e-06,  4.0489e-04,  4.6446e-04,  4.9619e-04,  5.0925e-04,
          5.3629e-04,  5.6055e-04,  5.9205e-04,  6.2536e-04,  6.6438e-04,
          7.0170e-04,  7.2987e-04,  7.5388e-04,  7.8317e-04,  8.1988e-04,
          8.5576e-04,  8.9208e-04,  9.3114e-04,  9.7016e-04,  1.0036e-03,
          1.0271e-03,  1.0445e-03,  1.0630e-03,  1.0848e-03,  1.1096e-03,
          1.1347e-03,  1.1599e-03,  1.1890e-03,  1.2216e-03,  1.2584e-03,
          1.2966e-03,  1.3338e-03,  1.3700e-03,  1.4038e-03,  1.4298e-03,
          1.4483e-03,  1.4556e-03,  1.4245e-03,  1.1957e-03, -5.5722e-05],
        [-5.0396e-06,  4.0613e-04,  4.6834e-04,  5.0503e-04,  5.2416e-04,
          5.5745e-04,  5.8661e-04,  6.2107e-04,  6.5553e-04,  6.9491e-04,
          7.3210e-04,  7.6049e-04,  7.8634e-04,  8.1993e-04,  8.6143e-04,
          9.0142e-04,  9.4009e-04,  9.7844e-04,  1.0137e-03,  1.0431e-03,
          1.0638e-03,  1.0802e-03,  1.1000e-03,  1.1244e-03,  1.1519e-03,
          1.1789e-03,  1.2051e-03,  1.2357e-03,  1.2713e-03,  1.3113e-03,
          1.3514e-03,  1.3889e-03,  1.4227e-03,  1.4508e-03,  1.4744e-03,
          1.4924e-03,  1.5014e-03,  1.4737e-03,  1.2495e-03,  2.7636e-06],
        [-4.1961e-06,  4.0870e-04,  4.7422e-04,  5.1596e-04,  5.4144e-04,
          5.8008e-04,  6.1261e-04,  6.4909e-04,  6.8471e-04,  7.2415e-04,
          7.6131e-04,  7.9089e-04,  8.1970e-04,  8.5702e-04,  9.0257e-04,
          9.4513e-04,  9.8290e-04,  1.0179e-03,  1.0492e-03,  1.0751e-03,
          1.0946e-03,  1.1125e-03,  1.1351e-03,  1.1624e-03,  1.1925e-03,
          1.2210e-03,  1.2498e-03,  1.2833e-03,  1.3223e-03,  1.3644e-03,
          1.4046e-03,  1.4396e-03,  1.4700e-03,  1.4955e-03,  1.5176e-03,
          1.5357e-03,  1.5470e-03,  1.5236e-03,  1.3048e-03,  6.4335e-05],
        [-2.8142e-06,  4.1281e-04,  4.8363e-04,  5.3193e-04,  5.6305e-04,
          6.0598e-04,  6.4118e-04,  6.7863e-04,  7.1389e-04,  7.5285e-04,
          7.9040e-04,  8.2168e-04,  8.5376e-04,  8.9503e-04,  9.4273e-04,
          9.8517e-04,  1.0208e-03,  1.0520e-03,  1.0797e-03,  1.1042e-03,
          1.1248e-03,  1.1448e-03,  1.1703e-03,  1.2001e-03,  1.2311e-03,
          1.2612e-03,  1.2923e-03,  1.3292e-03,  1.3711e-03,  1.4140e-03,
          1.4513e-03,  1.4813e-03,  1.5080e-03,  1.5318e-03,  1.5546e-03,
          1.5762e-03,  1.5917e-03,  1.5725e-03,  1.3564e-03,  1.1768e-04],
        [ 1.0098e-06,  4.2264e-04,  4.9999e-04,  5.5383e-04,  5.8925e-04,
          6.3458e-04,  6.6991e-04,  7.0655e-04,  7.4092e-04,  7.7920e-04,
          8.1755e-04,  8.5163e-04,  8.8737e-04,  9.3164e-04,  9.8085e-04,
          1.0222e-03,  1.0538e-03,  1.0811e-03,  1.1067e-03,  1.1310e-03,
          1.1529e-03,  1.1757e-03,  1.2034e-03,  1.2342e-03,  1.2658e-03,
          1.2979e-03,  1.3322e-03,  1.3721e-03,  1.4150e-03,  1.4568e-03,
          1.4917e-03,  1.5196e-03,  1.5433e-03,  1.5666e-03,  1.5911e-03,
          1.6155e-03,  1.6348e-03,  1.6193e-03,  1.4070e-03,  1.7192e-04],
        [ 5.3642e-06,  4.3343e-04,  5.1725e-04,  5.7576e-04,  6.1353e-04,
          6.5971e-04,  6.9484e-04,  7.3069e-04,  7.6444e-04,  8.0343e-04,
          8.4400e-04,  8.8106e-04,  9.1996e-04,  9.6608e-04,  1.0137e-03,
          1.0508e-03,  1.0781e-03,  1.1022e-03,  1.1267e-03,  1.1524e-03,
          1.1777e-03,  1.2034e-03,  1.2333e-03,  1.2658e-03,  1.3007e-03,
          1.3354e-03,  1.3723e-03,  1.4139e-03,  1.4564e-03,  1.4949e-03,
          1.5257e-03,  1.5497e-03,  1.5724e-03,  1.5963e-03,  1.6234e-03,
          1.6512e-03,  1.6739e-03,  1.6610e-03,  1.4510e-03,  2.1820e-04],
        [ 1.0048e-05,  4.4422e-04,  5.3282e-04,  5.9416e-04,  6.3352e-04,
          6.8018e-04,  7.1470e-04,  7.5051e-04,  7.8407e-04,  8.2397e-04,
          8.6656e-04,  9.0613e-04,  9.4660e-04,  9.9166e-04,  1.0362e-03,
          1.0692e-03,  1.0929e-03,  1.1162e-03,  1.1425e-03,  1.1711e-03,
          1.1993e-03,  1.2274e-03,  1.2590e-03,  1.2938e-03,  1.3304e-03,
          1.3683e-03,  1.4079e-03,  1.4499e-03,  1.4894e-03,  1.5236e-03,
          1.5504e-03,  1.5720e-03,  1.5949e-03,  1.6213e-03,  1.6516e-03,
          1.6822e-03,  1.7071e-03,  1.6957e-03,  1.4862e-03,  2.5290e-04],
        [ 1.3743e-05,  4.5239e-04,  5.4455e-04,  6.0767e-04,  6.4718e-04,
          6.9300e-04,  7.2608e-04,  7.6002e-04,  7.9481e-04,  8.3737e-04,
          8.8301e-04,  9.2464e-04,  9.6540e-04,  1.0087e-03,  1.0487e-03,
          1.0780e-03,  1.1003e-03,  1.1240e-03,  1.1526e-03,  1.1848e-03,
          1.2160e-03,  1.2458e-03,  1.2788e-03,  1.3144e-03,  1.3541e-03,
          1.3947e-03,  1.4344e-03,  1.4740e-03,  1.5096e-03,  1.5406e-03,
          1.5652e-03,  1.5876e-03,  1.6130e-03,  1.6428e-03,  1.6760e-03,
          1.7089e-03,  1.7345e-03,  1.7224e-03,  1.5114e-03,  2.7604e-04],
        [ 1.6298e-05,  4.5735e-04,  5.5038e-04,  6.1317e-04,  6.5200e-04,
          6.9657e-04,  7.3042e-04,  7.6533e-04,  8.0274e-04,  8.4836e-04,
          8.9644e-04,  9.3920e-04,  9.7819e-04,  1.0169e-03,  1.0535e-03,
          1.0798e-03,  1.1013e-03,  1.1270e-03,  1.1589e-03,  1.1944e-03,
          1.2278e-03,  1.2596e-03,  1.2946e-03,  1.3335e-03,  1.3756e-03,
          1.4165e-03,  1.4545e-03,  1.4907e-03,  1.5235e-03,  1.5516e-03,
          1.5763e-03,  1.6001e-03,  1.6273e-03,  1.6602e-03,  1.6955e-03,
          1.7290e-03,  1.7540e-03,  1.7403e-03,  1.5265e-03,  2.8684e-04],
        [ 1.6443e-05,  4.5758e-04,  5.5041e-04,  6.1278e-04,  6.5070e-04,
          6.9690e-04,  7.3177e-04,  7.7089e-04,  8.1100e-04,  8.5887e-04,
          9.0734e-04,  9.4688e-04,  9.8047e-04,  1.0137e-03,  1.0458e-03,
          1.0713e-03,  1.0953e-03,  1.1252e-03,  1.1614e-03,  1.2005e-03,
          1.2367e-03,  1.2709e-03,  1.3090e-03,  1.3507e-03,  1.3938e-03,
          1.4332e-03,  1.4673e-03,  1.4984e-03,  1.5274e-03,  1.5547e-03,
          1.5808e-03,  1.6082e-03,  1.6414e-03,  1.6767e-03,  1.7129e-03,
          1.7456e-03,  1.7686e-03,  1.7512e-03,  1.5323e-03,  2.8697e-04],
        [ 1.5543e-05,  4.5578e-04,  5.4741e-04,  6.0912e-04,  6.4732e-04,
          6.9353e-04,  7.3077e-04,  7.7362e-04,  8.1717e-04,  8.6629e-04,
          9.1274e-04,  9.4752e-04,  9.7475e-04,  1.0028e-03,  1.0335e-03,
          1.0611e-03,  1.0892e-03,  1.1235e-03,  1.1635e-03,  1.2050e-03,
          1.2440e-03,  1.2815e-03,  1.3231e-03,  1.3662e-03,  1.4073e-03,
          1.4413e-03,  1.4693e-03,  1.4961e-03,  1.5228e-03,  1.5518e-03,
          1.5820e-03,  1.6141e-03,  1.6506e-03,  1.6887e-03,  1.7257e-03,
          1.7566e-03,  1.7752e-03,  1.7522e-03,  1.5269e-03,  2.7219e-04],
        [ 1.5487e-05,  4.5386e-04,  5.4312e-04,  6.0177e-04,  6.3932e-04,
          6.8771e-04,  7.2932e-04,  7.7593e-04,  8.2315e-04,  8.7249e-04,
          9.1470e-04,  9.4225e-04,  9.6283e-04,  9.8794e-04,  1.0197e-03,
          1.0515e-03,  1.0848e-03,  1.1232e-03,  1.1655e-03,  1.2089e-03,
          1.2504e-03,  1.2918e-03,  1.3354e-03,  1.3767e-03,  1.4125e-03,
          1.4397e-03,  1.4615e-03,  1.4858e-03,  1.5146e-03,  1.5484e-03,
          1.5846e-03,  1.6224e-03,  1.6613e-03,  1.6991e-03,  1.7334e-03,
          1.7606e-03,  1.7750e-03,  1.7467e-03,  1.5154e-03,  2.6036e-04]]
tensor2 = [[ 0.0057,  0.0019,  0.0043,  0.0022, -0.0050, -0.0117, -0.0204, -0.0258,
         -0.0184, -0.0012],
        [ 0.0099,  0.0047,  0.0029, -0.0024, -0.0111, -0.0151, -0.0217, -0.0311,
         -0.0257,  0.0027],
        [ 0.0070, -0.0038, -0.0032, -0.0105, -0.0188, -0.0233, -0.0323, -0.0424,
         -0.0357, -0.0081],
        [-0.0004, -0.0109, -0.0125, -0.0185, -0.0259, -0.0307, -0.0411, -0.0499,
         -0.0418, -0.0111],
        [ 0.0064, -0.0075, -0.0087, -0.0139, -0.0208, -0.0270, -0.0350, -0.0424,
         -0.0328, -0.0056]]
tensor3 = [[-1.0963e-05,  3.2788e-04,  3.8498e-04,  4.5998e-04,  4.4347e-04,
          4.8904e-04,  4.7651e-04,  4.9455e-04,  4.8984e-04,  4.6200e-04,
          4.4192e-04,  4.6405e-04,  4.6395e-04,  4.6371e-04,  4.7736e-04,
          5.1821e-04,  5.2425e-04,  5.4840e-04,  5.7698e-04,  6.2108e-04,
          6.3914e-04,  6.7577e-04,  7.1245e-04,  7.6488e-04,  7.8738e-04,
          8.2344e-04,  8.4220e-04,  8.8441e-04,  9.0162e-04,  9.1793e-04,
          9.3785e-04,  9.4937e-04,  9.6881e-04,  9.6723e-04,  1.0315e-03,
          1.1464e-03,  1.2108e-03,  1.2830e-03,  1.0370e-03, -2.7221e-04],
        [-4.7400e-06,  3.6739e-04,  3.9803e-04,  4.3627e-04,  4.3131e-04,
          4.4108e-04,  4.6388e-04,  4.6197e-04,  4.5741e-04,  4.4515e-04,
          4.2558e-04,  4.3232e-04,  4.4167e-04,  4.5345e-04,  4.6530e-04,
          4.8790e-04,  5.1484e-04,  5.4090e-04,  5.6848e-04,  5.9337e-04,
          6.2831e-04,  6.5954e-04,  6.9650e-04,  7.2733e-04,  7.6262e-04,
          7.9480e-04,  8.2256e-04,  8.6216e-04,  8.8327e-04,  9.1409e-04,
          9.2479e-04,  9.3659e-04,  9.3761e-04,  9.6106e-04,  1.0091e-03,
          1.0607e-03,  1.1278e-03,  1.1201e-03,  9.1255e-04, -3.3403e-04],
        [-1.4779e-05,  3.2924e-04,  3.9119e-04,  4.3812e-04,  4.4751e-04,
          4.4440e-04,  4.7798e-04,  4.9003e-04,  4.9401e-04,  4.8685e-04,
          4.8644e-04,  4.9402e-04,  4.9407e-04,  5.0835e-04,  5.2960e-04,
          5.5454e-04,  5.8231e-04,  6.0922e-04,  6.4312e-04,  6.7151e-04,
          7.0350e-04,  7.3665e-04,  7.7695e-04,  8.1589e-04,  8.4609e-04,
          8.8402e-04,  9.1669e-04,  9.5515e-04,  9.8490e-04,  1.0077e-03,
          1.0331e-03,  1.0649e-03,  1.0911e-03,  1.0974e-03,  1.1497e-03,
          1.1808e-03,  1.2000e-03,  1.1867e-03,  9.3156e-04, -2.6888e-04],
        [-2.2707e-05,  3.4375e-04,  3.8023e-04,  4.1950e-04,  4.1341e-04,
          4.1279e-04,  4.3333e-04,  4.4590e-04,  4.3848e-04,  4.4152e-04,
          4.6552e-04,  4.8449e-04,  4.9849e-04,  5.1904e-04,  5.4868e-04,
          5.7846e-04,  6.1092e-04,  6.4375e-04,  6.7632e-04,  7.0428e-04,
          7.3217e-04,  7.6219e-04,  7.9779e-04,  8.2975e-04,  8.5628e-04,
          8.8632e-04,  9.1900e-04,  9.6149e-04,  9.8867e-04,  1.0108e-03,
          1.0366e-03,  1.0617e-03,  1.0776e-03,  1.0992e-03,  1.1398e-03,
          1.1669e-03,  1.1803e-03,  1.1872e-03,  9.3001e-04, -2.2682e-04],
        [-2.0942e-05,  3.7681e-04,  4.2972e-04,  4.6537e-04,  4.4796e-04,
          4.5664e-04,  4.7841e-04,  4.7897e-04,  4.7200e-04,  4.9881e-04,
          5.2574e-04,  5.4931e-04,  5.7048e-04,  5.9387e-04,  6.1871e-04,
          6.5301e-04,  6.9163e-04,  7.1900e-04,  7.5927e-04,  7.8820e-04,
          8.1977e-04,  8.4117e-04,  8.7174e-04,  8.9205e-04,  9.1234e-04,
          9.3033e-04,  9.5861e-04,  9.8308e-04,  1.0198e-03,  1.0495e-03,
          1.0837e-03,  1.1064e-03,  1.1405e-03,  1.1650e-03,  1.1894e-03,
          1.2254e-03,  1.2400e-03,  1.2512e-03,  9.8784e-04, -2.5282e-04],
        [-1.9497e-05,  3.8142e-04,  4.1807e-04,  4.5992e-04,  4.5017e-04,
          4.5268e-04,  4.6147e-04,  4.7843e-04,  4.7569e-04,  5.1114e-04,
          5.5825e-04,  5.8548e-04,  6.1774e-04,  6.3803e-04,  6.6473e-04,
          6.9167e-04,  7.3421e-04,  7.6567e-04,  8.0783e-04,  8.3048e-04,
          8.6339e-04,  8.8701e-04,  9.2154e-04,  9.3706e-04,  9.5524e-04,
          9.7219e-04,  9.9731e-04,  1.0177e-03,  1.0477e-03,  1.0698e-03,
          1.1029e-03,  1.1286e-03,  1.1509e-03,  1.1967e-03,  1.2422e-03,
          1.2707e-03,  1.3019e-03,  1.2738e-03,  9.9551e-04, -2.1385e-04],
        [-8.1698e-06,  3.7557e-04,  4.1775e-04,  4.6983e-04,  4.7057e-04,
          4.6999e-04,  4.8272e-04,  4.9952e-04,  5.1529e-04,  5.4526e-04,
          5.8685e-04,  6.1952e-04,  6.5226e-04,  6.7794e-04,  7.0780e-04,
          7.4494e-04,  7.8800e-04,  8.1525e-04,  8.4921e-04,  8.7707e-04,
          9.0199e-04,  9.2278e-04,  9.4730e-04,  9.6429e-04,  9.7173e-04,
          9.8930e-04,  1.0103e-03,  1.0322e-03,  1.0604e-03,  1.1004e-03,
          1.1425e-03,  1.1687e-03,  1.2055e-03,  1.2242e-03,  1.2618e-03,
          1.3038e-03,  1.3319e-03,  1.3259e-03,  1.0414e-03, -2.0213e-04],
        [-1.5619e-05,  3.7968e-04,  4.3573e-04,  4.9218e-04,  4.7759e-04,
          4.8866e-04,  4.9923e-04,  5.2236e-04,  5.3878e-04,  5.6644e-04,
          6.0801e-04,  6.4164e-04,  6.8034e-04,  7.0957e-04,  7.4110e-04,
          7.8110e-04,  8.2699e-04,  8.5438e-04,  8.8962e-04,  9.1647e-04,
          9.4409e-04,  9.6407e-04,  9.9149e-04,  1.0059e-03,  1.0179e-03,
          1.0390e-03,  1.0716e-03,  1.0931e-03,  1.1324e-03,  1.1670e-03,
          1.2082e-03,  1.2288e-03,  1.2622e-03,  1.2855e-03,  1.3179e-03,
          1.3554e-03,  1.3662e-03,  1.3405e-03,  1.0503e-03, -1.6070e-04],
        [-8.0658e-06,  3.8885e-04,  4.4394e-04,  4.9041e-04,  4.8919e-04,
          5.0259e-04,  5.2484e-04,  5.4188e-04,  5.6206e-04,  5.9387e-04,
          6.2397e-04,  6.5671e-04,  7.0402e-04,  7.3632e-04,  7.7291e-04,
          8.1413e-04,  8.6035e-04,  8.8654e-04,  9.1824e-04,  9.4490e-04,
          9.7623e-04,  9.9447e-04,  1.0152e-03,  1.0360e-03,  1.0545e-03,
          1.0844e-03,  1.1217e-03,  1.1493e-03,  1.1831e-03,  1.2115e-03,
          1.2695e-03,  1.2991e-03,  1.3395e-03,  1.3649e-03,  1.4013e-03,
          1.4442e-03,  1.4530e-03,  1.4380e-03,  1.1235e-03, -1.1541e-04],
        [-1.1824e-05,  3.8446e-04,  4.4854e-04,  5.0280e-04,  4.9682e-04,
          5.2439e-04,  5.5234e-04,  5.8094e-04,  6.0569e-04,  6.3807e-04,
          6.7241e-04,  7.0361e-04,  7.5424e-04,  7.8081e-04,  8.1908e-04,
          8.5132e-04,  9.0027e-04,  9.2000e-04,  9.4545e-04,  9.7073e-04,
          1.0021e-03,  1.0194e-03,  1.0416e-03,  1.0654e-03,  1.0849e-03,
          1.1156e-03,  1.1535e-03,  1.1857e-03,  1.2242e-03,  1.2528e-03,
          1.3062e-03,  1.3368e-03,  1.3770e-03,  1.4053e-03,  1.4375e-03,
          1.4824e-03,  1.4949e-03,  1.4945e-03,  1.1775e-03, -5.1935e-05],
        [-6.1117e-06,  3.9880e-04,  4.5527e-04,  5.0593e-04,  5.0294e-04,
          5.2860e-04,  5.7462e-04,  6.0252e-04,  6.3309e-04,  6.7017e-04,
          7.2005e-04,  7.5499e-04,  8.0895e-04,  8.4062e-04,  8.7868e-04,
          9.1942e-04,  9.6077e-04,  9.8200e-04,  1.0028e-03,  1.0279e-03,
          1.0443e-03,  1.0646e-03,  1.0832e-03,  1.1080e-03,  1.1316e-03,
          1.1656e-03,  1.2029e-03,  1.2333e-03,  1.2688e-03,  1.2999e-03,
          1.3474e-03,  1.3841e-03,  1.4265e-03,  1.4532e-03,  1.5051e-03,
          1.5438e-03,  1.5549e-03,  1.5298e-03,  1.2181e-03, -4.0355e-06],
        [-1.2843e-05,  4.0269e-04,  4.5962e-04,  5.1761e-04,  5.2779e-04,
          5.5098e-04,  6.0464e-04,  6.3109e-04,  6.6915e-04,  7.1071e-04,
          7.5827e-04,  7.9325e-04,  8.4573e-04,  8.7622e-04,  9.1397e-04,
          9.5523e-04,  9.9539e-04,  1.0126e-03,  1.0348e-03,  1.0546e-03,
          1.0752e-03,  1.0922e-03,  1.1149e-03,  1.1437e-03,  1.1730e-03,
          1.2117e-03,  1.2526e-03,  1.2884e-03,  1.3225e-03,  1.3559e-03,
          1.4041e-03,  1.4332e-03,  1.4716e-03,  1.5039e-03,  1.5316e-03,
          1.5701e-03,  1.5863e-03,  1.5766e-03,  1.2745e-03,  5.4232e-05],
        [ 1.2575e-06,  4.1635e-04,  4.7161e-04,  5.3161e-04,  5.5863e-04,
          5.9078e-04,  6.3766e-04,  6.6570e-04,  7.0303e-04,  7.4062e-04,
          7.9784e-04,  8.4020e-04,  9.0041e-04,  9.3183e-04,  9.5958e-04,
          9.9910e-04,  1.0392e-03,  1.0575e-03,  1.0776e-03,  1.0996e-03,
          1.1170e-03,  1.1333e-03,  1.1546e-03,  1.1860e-03,  1.2181e-03,
          1.2629e-03,  1.3084e-03,  1.3508e-03,  1.3809e-03,  1.4164e-03,
          1.4512e-03,  1.4847e-03,  1.5127e-03,  1.5396e-03,  1.5867e-03,
          1.6125e-03,  1.6474e-03,  1.6454e-03,  1.3638e-03,  1.5763e-04],
        [ 1.1369e-06,  4.3346e-04,  4.8330e-04,  5.5036e-04,  5.7946e-04,
          6.0859e-04,  6.5778e-04,  6.9122e-04,  7.2952e-04,  7.6805e-04,
          8.2408e-04,  8.6848e-04,  9.1878e-04,  9.5025e-04,  9.7569e-04,
          1.0125e-03,  1.0542e-03,  1.0710e-03,  1.0948e-03,  1.1166e-03,
          1.1376e-03,  1.1534e-03,  1.1766e-03,  1.2128e-03,  1.2496e-03,
          1.3021e-03,  1.3534e-03,  1.3937e-03,  1.4309e-03,  1.4620e-03,
          1.5004e-03,  1.5278e-03,  1.5617e-03,  1.5729e-03,  1.6207e-03,
          1.6499e-03,  1.6838e-03,  1.6919e-03,  1.4096e-03,  2.0045e-04],
        [ 1.0442e-05,  4.2660e-04,  5.0022e-04,  5.8162e-04,  6.1682e-04,
          6.6260e-04,  6.9879e-04,  7.4112e-04,  7.5863e-04,  7.9502e-04,
          8.5780e-04,  8.9336e-04,  9.4766e-04,  9.7328e-04,  1.0030e-03,
          1.0360e-03,  1.0728e-03,  1.0872e-03,  1.1022e-03,  1.1259e-03,
          1.1504e-03,  1.1716e-03,  1.1977e-03,  1.2389e-03,  1.2835e-03,
          1.3357e-03,  1.3936e-03,  1.4370e-03,  1.4812e-03,  1.5208e-03,
          1.5601e-03,  1.5852e-03,  1.5963e-03,  1.6159e-03,  1.6525e-03,
          1.6770e-03,  1.6968e-03,  1.7031e-03,  1.4566e-03,  2.4118e-04],
        [ 2.0052e-05,  4.5317e-04,  5.1026e-04,  5.9012e-04,  6.3461e-04,
          6.8846e-04,  7.4656e-04,  7.9012e-04,  8.1738e-04,  8.5337e-04,
          9.0667e-04,  9.3557e-04,  9.8546e-04,  1.0130e-03,  1.0446e-03,
          1.0786e-03,  1.1120e-03,  1.1279e-03,  1.1478e-03,  1.1752e-03,
          1.1974e-03,  1.2203e-03,  1.2489e-03,  1.2904e-03,  1.3304e-03,
          1.3810e-03,  1.4358e-03,  1.4728e-03,  1.5127e-03,  1.5585e-03,
          1.6024e-03,  1.6333e-03,  1.6524e-03,  1.6681e-03,  1.6895e-03,
          1.7176e-03,  1.7625e-03,  1.7237e-03,  1.4701e-03,  2.4713e-04],
        [ 1.3499e-05,  4.2016e-04,  5.0251e-04,  5.6485e-04,  6.3325e-04,
          6.9541e-04,  7.3491e-04,  7.8788e-04,  8.2004e-04,  8.7117e-04,
          9.2077e-04,  9.4552e-04,  9.7355e-04,  9.9846e-04,  1.0169e-03,
          1.0468e-03,  1.0742e-03,  1.0986e-03,  1.1217e-03,  1.1531e-03,
          1.1877e-03,  1.2230e-03,  1.2604e-03,  1.2965e-03,  1.3277e-03,
          1.3757e-03,  1.4255e-03,  1.4617e-03,  1.4939e-03,  1.5359e-03,
          1.5793e-03,  1.6147e-03,  1.6467e-03,  1.6764e-03,  1.7219e-03,
          1.7413e-03,  1.7707e-03,  1.7382e-03,  1.4680e-03,  2.7281e-04],
        [ 6.6368e-06,  4.1726e-04,  5.0644e-04,  5.4111e-04,  6.2895e-04,
          6.6804e-04,  7.3045e-04,  7.7646e-04,  8.1074e-04,  8.6458e-04,
          9.1811e-04,  9.5259e-04,  9.7267e-04,  9.9844e-04,  1.0285e-03,
          1.0688e-03,  1.0900e-03,  1.1187e-03,  1.1454e-03,  1.1885e-03,
          1.2228e-03,  1.2654e-03,  1.3031e-03,  1.3494e-03,  1.3742e-03,
          1.4226e-03,  1.4715e-03,  1.5125e-03,  1.5387e-03,  1.5842e-03,
          1.6371e-03,  1.6696e-03,  1.7015e-03,  1.6984e-03,  1.7353e-03,
          1.7500e-03,  1.7512e-03,  1.7302e-03,  1.4564e-03,  2.8276e-04],
        [ 1.5267e-05,  4.5851e-04,  5.1299e-04,  6.0777e-04,  6.3644e-04,
          6.8415e-04,  7.7087e-04,  7.9544e-04,  8.4054e-04,  8.8269e-04,
          9.2297e-04,  9.4472e-04,  1.0016e-03,  1.0188e-03,  1.0512e-03,
          1.0827e-03,  1.1267e-03,  1.1484e-03,  1.1790e-03,  1.2175e-03,
          1.2606e-03,  1.2972e-03,  1.3309e-03,  1.3748e-03,  1.4079e-03,
          1.4400e-03,  1.4819e-03,  1.5196e-03,  1.5546e-03,  1.5860e-03,
          1.6331e-03,  1.6568e-03,  1.6919e-03,  1.7291e-03,  1.7164e-03,
          1.7144e-03,  1.7162e-03,  1.7113e-03,  1.4148e-03,  2.1232e-04],
        [ 2.9676e-05,  5.2015e-04,  5.5044e-04,  6.5329e-04,  6.5420e-04,
          7.1733e-04,  8.0814e-04,  8.4646e-04,  8.6813e-04,  9.0890e-04,
          9.5752e-04,  9.8073e-04,  1.0271e-03,  1.0529e-03,  1.0749e-03,
          1.1010e-03,  1.1257e-03,  1.1541e-03,  1.1834e-03,  1.2195e-03,
          1.2575e-03,  1.3024e-03,  1.3504e-03,  1.3991e-03,  1.4255e-03,
          1.4592e-03,  1.5033e-03,  1.5387e-03,  1.5729e-03,  1.5892e-03,
          1.6292e-03,  1.6554e-03,  1.6970e-03,  1.7177e-03,  1.7191e-03,
          1.6987e-03,  1.6800e-03,  1.6658e-03,  1.3786e-03,  2.1947e-04]]
g_l = [0.005872036796063185, 0.0028774922247976065, 0.003779064631089568, 0.0018976964056491852, 0.0010626084404066205, 0.001830042339861393, 0.0021179786417633295, 0.0015340850222855806, 0.004269980359822512, 0.0007851796108298004, 0.0008892713231034577, 0.001434761448763311, 0.0018338545924052596, 0.0008280057227239013, 0.0006946084322407842, 0.0011167407501488924, 0.0016294638626277447, 0.0014395214384421706, 0.0007557097123935819, 0.0009338186355307698, 0.0017276997677981853, 0.0007949707796797156, 0.0006375072407536209, 0.0008605637704022229, 0.0014210977824404836, 0.0008867340511642396, 0.0006397739052772522, 0.000778325367718935, 0.0011845064582303166, 0.0007592182955704629, 0.000507568649481982, 0.0005991120706312358, 0.0006031874218024313, 0.0005882096011191607, 0.0007648004102520645, 0.0007705545285716653, 0.0006170142441987991, 0.0009863338200375438, 0.00044413976138457656, 0.000760930182877928, 0.0007170738535933197, 0.0009026743355207145, 0.0005937329260632396, 0.0005293737049214542, 0.0005913811619393528, 0.0006169929401949048, 0.0005864416598342359, 0.00043394259409978986, 0.00040980984340421855, 0.0007570006418973207]
g_lc = [0.005892464891076088, 0.0028928129468113184, 0.003789302194491029, 0.001914115040563047, 0.0010703353909775615, 0.0018433855148032308, 0.0021357375662773848, 0.0015456444816663861, 0.004280870780348778, 0.0007918873452581465, 0.0008971905335783958, 0.0014461246319115162, 0.0018491409718990326, 0.0008350118296220899, 0.0007010982371866703, 0.0011267412919551134, 0.0016423949273303151, 0.0014526016311720014, 0.0007624754216521978, 0.0009410199127160013, 0.0017425245605409145, 0.0008021597750484943, 0.0006435332470573485, 0.0008682615007273853, 0.001431871671229601, 0.0008949209586717188, 0.0006458491552621126, 0.0007853685528971255, 0.0011944710277020931, 0.0007664125878363848, 0.0005124627496115863, 0.0006048514042049646, 0.0006089354283176363, 0.0005938233225606382, 0.0007719406858086586, 0.000777614361140877, 0.0006223443779163063, 0.0009938618168234825, 0.00044817037996836007, 0.000768090772908181, 0.0007233982905745506, 0.0009110094397328794, 0.0005993711529299617, 0.0005344548844732344, 0.0005969094345346093, 0.0006228364072740078, 0.0005918027018196881, 0.0004381071776151657, 0.00041359482565894723, 0.0007635492947883904]
g_lk_row = [0.0018835021182894707, 0.001027317252010107, 0.0016459161415696144, 0.00013618060620501637, 0.0002296885650139302, 0.00022735561651643366, 0.0001717451523290947, 0.00022561241348739713, 0.0014680034946650267, 6.892731471452862e-05, 8.159739809343591e-05, 0.00014820862270426005, 0.00013301664148457348, 0.00014916391228325665, 2.9331291443668306e-05, 8.668236841913313e-05, 0.00016953716112766415, 5.6619268434587866e-05, 6.440627475967631e-05, 0.00015190830163192004, 0.00012445132597349584, 5.757516191806644e-05, 2.2912568965693936e-05, 4.90177480969578e-05, 0.00018161481420975178, 4.12560511904303e-05, 2.766008947219234e-05, 5.5049888032954186e-05, 7.476018799934536e-05, 2.9224122044979595e-05, 1.4262181139201857e-05, 1.682955917203799e-05, 1.7342541468678974e-05, 2.0090983525733463e-05, 3.0209519536583684e-05, 4.246150274411775e-05, 4.8347679694416e-05, 0.0001468574337195605, 2.7226929887547158e-05, 2.7279844289296307e-05, 5.6612872867845e-05, 2.354741263843607e-05, 1.4400774489331525e-05, 1.1557423022168223e-05, 1.871440326794982e-05, 2.1175128495087847e-05, 1.9186727513442747e-05, 1.258677184523549e-05, 1.7344096704619005e-05, 6.044043766451068e-05]
g_lk_col = [0.0058157965540885925, 0.0016941792564466596, 0.003885157173499465, 0.0004083042440470308, 0.00036559419822879136, 0.0007907519466243684, 0.0005479569081217051, 0.000553783611394465, 0.004915655590593815, 0.0001732914533931762, 0.00012894019891973585, 0.0004713831003755331, 0.000507982331328094, 0.0001196431476273574, 7.490552525268868e-05, 0.00016667411546222866, 0.000529046228621155, 0.00023252548999153078, 0.00010739935532910749, 0.0002898736856877804, 0.0003956406726501882, 0.00010894297884078696, 5.895516005693935e-05, 0.00014795355673413724, 0.0005273676943033934, 0.000111205386929214, 4.8981855798047036e-05, 0.00010704644228098914, 0.0003212660667486489, 6.474507245002314e-05, 3.184243178111501e-05, 4.5010921894572675e-05, 5.0917438784381375e-05, 4.481010910240002e-05, 8.561267895856872e-05, 0.00010080308129545301, 0.00013031454000156373, 0.00033527513733133674, 6.298863445408642e-05, 7.67912351875566e-05, 0.00012529546802397817, 0.0001314423861913383, 5.669646634487435e-05, 4.112172973691486e-05, 6.943873449927196e-05, 5.5798063840484247e-05, 9.221687651006505e-05, 3.0708270060131326e-05, 5.2847877668682486e-05, 0.00015692632587160915]


fig1 = plt.figure(figsize=(18, 10))
fig1.add_subplot(224)
x_data = list(range(50))
plt.plot(x_data, g_l, label='Generator\'s loss')
plt.plot(x_data, g_lc, label='Pixel-wise loss')
plt.plot(x_data, g_lk_row, label='KL divergence loss row')
plt.plot(x_data, g_lk_col, label='KL divergence loss col')
plt.xlabel('Number of epochs')
plt.ylabel('Loss')
plt.legend(loc=1)
# layer to plot
ilayer = 0
# fontsize
fs = 18
hfont = {'fontname':'Arial'}

# number of layers
nlay = 1
# Grid cell size
grid_size = [0.25, 0.25, 0.25] # selected units [cm]
# Define grid
# Describe grid for results
Lx = (40) * grid_size[1]   # length of model in selected units
Ly = (20) * grid_size[0]   # length of model in selected units
y, x = np.mgrid[slice(0, Ly + grid_size[0], grid_size[0]),
                slice(0, Lx + grid_size[1], grid_size[1])]

# The latent vector's size is 5 by 10
latent_x = (10) * grid_size[1]
latent_y = (5) * grid_size[0]
l_y, l_x = np.mgrid[slice(0, latent_y + grid_size[0], grid_size[0]),
                    slice(0, latent_x + grid_size[1], grid_size[1])]

inp_img = tensor1
latent_img = tensor2
dec_img = tensor3


ax0 = fig1.add_subplot(2, 2, 1, aspect='equal')
imp = plt.pcolor(x, y, inp_img, cmap='RdYlBu_r', edgecolors='k', linewidths=0.2)
cbar = plt.colorbar()
cbar.set_label('Pore Volumes', fontsize=fs-5, **hfont)
cbar.ax.tick_params(labelsize= (fs-2))
ax0.tick_params(axis='both', which='major', labelsize=fs)
ax0.set_xlabel('Distance from inlet [cm]', fontsize=fs-5, **hfont)
plt.ylabel('Distance [cm]', fontsize=fs-5, **hfont)
plt.title('Input Breakthrough Time Difference Map', fontsize=fs, **hfont)

ax2 = fig1.add_subplot(2, 2, 2, aspect='equal')
imp = plt.pcolor(l_x, l_y, latent_img, cmap='RdYlBu_r', edgecolors='k', linewidths=0.2)
cbar = plt.colorbar()
cbar.ax.tick_params(labelsize= (fs-2))
ax2.tick_params(axis='both', which='major', labelsize=fs)
plt.title('Latent Map', fontsize=fs, **hfont)

ax2 = fig1.add_subplot(2, 2, 3, aspect='equal')
imp = plt.pcolor(x, y, dec_img, cmap='RdYlBu_r', edgecolors='k', linewidths=0.2)
cbar = plt.colorbar()
cbar.set_label('Pore Volumes', fontsize=fs-5, **hfont)
cbar.ax.tick_params(labelsize= (fs-2))
ax2.tick_params(axis='both', which='major', labelsize=fs)
ax2.set_xlabel('Distance from inlet [cm]', fontsize=fs-5, **hfont)
plt.ylabel('Distance [cm]', fontsize=fs-5, **hfont)
plt.title('Decoded Breakthrough Time Difference Map', fontsize=fs, **hfont)

plt.show()
